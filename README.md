# mse_public_speaking_training

Env:
pip install Python-pptx
pip install SpeechRecognition
pip install time
pip install django


Работа парсера:
1) Подключение библиотеки python-pptx
2) Для получения списка слайдов используем функцию slides(), в результате получаем список слайдов.
3) Затем делаем словарь слайд - текст или наоборот)
Список слайдов у нас есть, проходим по нему и в для каждого слайда выполняем код:
	text_slide = " "
	for shape in slide.shapes:
		if not shape.has_text_frame:
			continue
		text_slide += shape.text_frame + "\n"
И добавляем text_slide в словарь вместе с текстом
![Image alt](https://github.com/moevm/mse_public_speaking_training/raw/master/image/parser.png)


Работа модуля обработки звука:
1) Подключается библиотека speech_recognition
2) Начинается запись речи, которая продолжается до отстановки речи пользователя 
3) Записанная речь отправляется на обработку с помощью recognize_google_api
В результате получаем переменную типа String с распознанным текстом
![Image alt](https://github.com/moevm/mse_public_speaking_training/raw/master/image/sound.png)

Работа модуля анализа полученных данных:
А. def massWord(mass):
	1) На вход получаем список записанных аудиофайлов
	2) Каждый элемент список отправляется на обработку функции из модуля обработки звука.
	3) На выходе получаем список из сказанного текста на каждом слайде

B. def wordsOnSlide(listWord):
	1) На вход получаем список полученный из функции massWord
	2) Подсчитываем количество слов в каждом элементе этого списка
	3) На выходе список из количества слов, сказанного во время просмотра презентации

С. def simpleSpeed(time, countWord):
	Реализован простой подсчет скорости, т.е. считаем, что в процессе показа одного слайда скорость постоянная
	1) На вход получаем список секунд, в которые заканчивается показ слайдов и список из wordsOnSlide
	2) Для получения списка скоростей говорящего на каждом слайде проходимся по списку time и считаем, сколько секунд затратили на данный слайд. В этом же цикле делим число сказанных слов на количество секунд и получаем скорость на данном слайде.
	3) Строим график скорость с помощью полученных данных.
![Image alt](https://github.com/moevm/mse_public_speaking_training/raw/master/image/speed.png)

D. def SpeedReport(time, countWord):
	1) На вход получаем списк секунд, в которые заканчивается данный слайд и список из wordsOnSlide
	2) Подсчитываем количество секунд, которое тратится на каждый слайд.
	3) Находим среднее количество секунд, потраченное на один слайд
	4) Строим график, на котором показано среднее количество секунд (красный пунктир) и количество секунд, потраченное на каждый слайд
	[Image alt](https://github.com/moevm/mse_public_speaking_training/raw/master/image/time.png)
	5) Находим среднее количество слов, потраченное на один слайд
	6) Строим график, на котором показано среднее количество слов (красный пунктир) и количество слов, потраченное на каждый слайд
	[Image alt](https://github.com/moevm/mse_public_speaking_training/raw/master/image/slide.png)

E. def comparisionOfTheme(dict, listWord):
	1) На вход получаем список с текстом из слайдов и список поллученный из massWord
	2) Для каждого слайда:
		а) Составляем словарь, в котором ключом является слово, а значением количество таких слов в тексте на слайде
		б) Составляем словарь, в котором ключом является слово, а значением количество таких слов в сказанном тексте пользователем на данном слайде
		в) Производим сопоставление этих двух списков и подсчитываем количество слов, которое встречается в тексте на слайде и в сказанном пользователем тексте
		г) Подсчитываем процент сказанных слов со слайда
	[Image alt](https://github.com/moevm/mse_public_speaking_training/raw/master/image/data.png)
	[Image alt](https://github.com/moevm/mse_public_speaking_training/raw/master/image/result.png)
